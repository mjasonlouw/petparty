<div id="chatContainer">

    <div id="splitViews">

        

        <div id="parytChats">
            <p>
                Partys Chats
            </p>
            
            <div *ngFor="let party of allPartys">
                <div *ngIf="joinedParty(party.usersID)">
                    <div  id="party" (click)="openChat(party.id)">
                        <div class="imageDiv">
                            <img src="../../assets/images/purpleMonster.png" id="partyImage">
                        </div>
                        <div class="partyName">
                            <p class="name">{{party.name}}</p>
                            <!-- <p class="recentMessage">
                                This should be the most recent message
                            </p> -->
                        </div>
                        <div class="unreadMessages">
                            {{calculateUnreadMessages(party)}}
                        </div>
                    </div>
                    
                    <!-- <hr class="underlinePartys"> -->
                </div>
                    
            </div>
        </div>

        <div *ngIf="inChat && activeChat" id="parytChat">
            <div (click)="closeChat()">x</div>
            <p>
                {{activeChat.name}}
            </p>
            
            <div style="overflow: scroll;">
                <div id="allMessages">
                    <div *ngFor="let message of allChats[activeChat.id].messages">
                        <div class="messageBubbleMe">
                            
                            <div class="messageCreatorName">{{message.creator}}</div>
                            <div *ngIf="message.image != '' && message.image != null" class="messageImageHolder">
                                <img [src]="createUrl(message.image)" (error)="failedTo(activeChat.id, message.id)" style="width:90%; border-radius: 10px;" >
                            </div>
                            <div [innerHTML]="message.content" class="messageContent"></div>
                        </div>
                    </div>
                </div>
                

                <form  (ngSubmit)="sendMessage(activeChat.id)">
                    <div class="messagePictureSendHolder">
                        
                        <div class="messageBox">
                            <div class="previewImageHolder" *ngIf="previewUrl != null">
                                <img [src]="previewUrl" style="width: 100%; border-radius: 10px;">
                            </div>
                            <div #postStatus contenteditable="true" class="form-control" id="textBox" placeholder=""  (keyup)="typing($event)"></div>
                            <div class="photoPickerHolder">
                                <input type="file" (change)="onFileSelected($event)" class="inputfile" name="file" id="file" accept="image/*">
                                <label for="file"><div  class="imageUploadLabel"><mat-icon style="color: white;">insert_photo</mat-icon></div></label>
                            </div>
                            
        
                            
                        </div>
                        <div class="SendDivHolder">
                            <button class="button" type="submit"><mat-icon style="color: white;">send</mat-icon></button>
                        </div>
                    </div>
                </form>
                
            </div>
        </div>
            
    </div>
    
</div>
